{% extends "base_portal.html" %}

{% block head_extra %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css" rel="stylesheet">
{% endblock %}

{% block page_content %}
<div class="secure-card">
  <h2 class="secure-card-title">
    <i class="bi bi-shield-lock"></i>
    Secure Page
  </h2>
  
  <p>
    <strong>Hello, {{ preferred_username|default('User') }} ({{ email|default('No email provided') }})!</strong>
  </p>
  <p>
    You have successfully accessed a protected page through OIDC authentication.
  </p>
  
  {% if groups %}
  <div class="mt-3">
    <h5 class="h6">
      <i class="bi bi-people"></i>
      Your Groups:
    </h5>
    <ul class="list-unstyled">
      {% for group in groups %}
      <li><span class="badge bg-secondary me-1">{{ group }}</span></li>
      {% endfor %}
    </ul>
  </div>
  {% else %}
  <div class="mt-3">
    <h5 class="h6">
      <i class="bi bi-info-circle"></i>
      No Groups Found
    </h5>
    <p class="text-muted mb-0">You are not a member of any groups.</p>
  </div>
  {% endif %}
  
  <!-- DEBUG: Show all auth headers -->
  {% if all_headers %}
  <div class="mt-4 p-3 bg-light rounded">
    <h6><i class="bi bi-bug"></i> Debug: Authentication Headers</h6>
    <small class="text-muted">
      {% for header, value in all_headers.items() %}
      <strong>{{ header }}:</strong> {{ value }}<br>
      {% endfor %}
    </small>
  </div>
  {% endif %}
  
  <div class="secure-card-actions">
    <a href="/logout/oidc" class="btn btn-danger">
      <i class="bi bi-box-arrow-right"></i>
      Logout
    </a>
    <a href="/" class="btn btn-primary">
      <i class="bi bi-house"></i>
      Back to Dashboard
    </a>
  </div>
</div>
{% endblock %} 